<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Andre Ai</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s ease;
            overflow: hidden; /* Mencegah scrolling saat loading */
        }
        .chatbox {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 500px;
            z-index: 1000;
            display: none;
            flex-direction: column;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(100%);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        .chatbox.active {
            display: flex;
            transform: translateY(0);
            opacity: 1;
        }
        .chat-icon {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1001;
            cursor: pointer;
            width: 60px;
            height: 60px;
            background-color: #ec4899;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .chat-icon:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }
        .chat-message {
            max-width: 85%;
            padding: 8px 12px;
            border-radius: 18px;
            margin-bottom: 8px;
            word-wrap: break-word;
        }
        .user-message {
            background-color: #ec4899;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }
        .ai-message {
            background-color: #fbcfe8;
            color: #1f2937;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }
        .typing-indicator span {
            animation: bounce 0.8s infinite;
        }
        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-4px);
            }
        }
        .typewriter-text {
            display: inline-block;
            white-space: nowrap;
            overflow: hidden;
        }
        .typewriter-cursor {
            border-right: 2px solid #1f2937;
            animation: blink 0.75s step-end infinite;
        }
        @keyframes blink {
            from, to { border-color: transparent }
            50% { border-color: #1f2937; }
        }
        @media (max-width: 768px) {
            .chatbox {
                width: 90%;
                height: 80vh;
                left: 5%;
                bottom: 5vh;
            }
            .chat-icon {
                bottom: 20px;
                right: 20px;
            }
        }

        /* Gaya untuk animasi loading */
        #loader-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #fdf2f8;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease;
        }
        #loader-container.hidden {
            opacity: 0;
            pointer-events: none;
        }
        .loader {
            border: 8px solid #f3e5f5;
            border-top: 8px solid #f472b6;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-rose-50 text-gray-800 transition-colors duration-300">

    <!-- Animasi Loading -->
    <div id="loader-container">
        <div class="loader"></div>
    </div>

    <!-- Konten Utama Website -->
    <div id="main-content" class="hidden-by-js">
        <!-- Navbar -->
        <nav class="fixed top-0 left-0 w-full bg-rose-100 bg-opacity-80 backdrop-blur-md z-50 shadow-sm transition-colors duration-300">
            <div class="container mx-auto px-4 py-4 flex justify-between items-center">
                <a href="#" class="font-bold text-xl text-pink-600 rounded-md">Andre Ai</a>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="min-h-screen pt-20 pb-10 flex flex-col items-center justify-center">

            <!-- Profile Section -->
            <section class="w-full max-w-4xl p-8 md:p-12 bg-rose-100 rounded-2xl shadow-lg text-center transform hover:scale-105 transition-transform duration-300">
                <div class="flex flex-col items-center">
                    <img src="Andre.jpg" alt="Foto Profil" class="rounded-full w-36 h-36 mb-6 border-4 border-pink-500">
                    <h1 class="text-4xl font-bold text-gray-900 mb-2">Andre Ai</h1>
                    <!-- Elemen untuk efek mengetik -->
                    <p id="typewriter-text" class="text-xl text-gray-600 mb-6 font-medium typewriter-cursor"></p>
                    <div class="text-md text-gray-500 leading-relaxed max-w-2xl mx-auto text-center">
                        <p>hallo! saya adalah Andre AI, siap membantu Anda kapan pun Anda mau! ðŸ˜Š</p>
                        <p class="mt-4">Tuliskan pertanyaan atau kebutuhan Anda, kami siap membantu Anda dengan senang hati. Klik ikon pesan untuk memulai percakapan dengan saya! ðŸ’¬</p>
                        <p class="mt-4">Saya di sini untuk membantu Anda dengan:</p>
                        <ul class="list-disc list-inside mt-2 text-left">
                            <li>Menjawab pertanyaan</li>
                            <li>Memberikan informasi</li>
                            <li>Membantu menyelesaikan masalah</li>
                        </ul>
                        <p class="mt-4">Jangan ragu untuk bertanya, saya siap membantu Anda! ðŸ˜Š</p>
                    </div>
                </div>
            </section>

            <!-- Contact Section (Text Only) -->
            <section class="w-full max-w-4xl p-8 md:p-12 mt-10 bg-rose-100 rounded-2xl shadow-lg transform hover:scale-105 transition-transform duration-300">
                <h2 class="text-3xl font-bold mb-4 text-gray-900">Kontak Developer</h2>
                <div class="space-y-4 text-gray-700">
                    <p>
                        Jika Anda memiliki pertanyaan, atau hanya ingin menyapa, jangan ragu untuk menghubungi saya melalui informasi di bawah ini.
                    </p>
                    <ul class="list-disc list-inside space-y-2">
                        <li>Email: <a href="mailto:andreaan111109@email.com" class="text-pink-600 hover:underline">andreaan111109@email.com</a></li>
                        <li>Telepon: <a href="tel:+6283845584667" class="text-pink-600 hover:underline">+62 838-4558-4667</a></li>
                        <li>Lokasi: Sumatra Selatan, Indonesia</li>
                    </ul>
                </div>
            </section>
        </main>

        <!-- Footer with Copyright -->
        <footer class="w-full text-center py-4">
            <p class="text-sm text-gray-500">
                Copyright Â© 2025 Andre Ai
            </p>
        </footer>

        <!-- Chat AI Icon -->
        <div id="chat-icon" class="chat-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z" />
            </svg>
        </div>

        <!-- Chat AI Box -->
        <div id="chatbox" class="chatbox bg-rose-100 text-gray-800 shadow-xl border border-gray-300">
            <!-- Chat Header -->
            <div class="flex items-center justify-between p-4 border-b border-gray-300 bg-rose-200 rounded-t-xl">
                <h3 class="font-bold text-lg">Andre AI</h3>
                <div class="flex items-center space-x-2">
                    <select id="ai-mode-selector" class="p-1 text-sm rounded-md bg-white border border-gray-300">
                        <option value="Logic">Mode Ai</option>
                        <option value="Joking">Mode Bersenang</option>
                        <option value="Angry">Mode Marah</option>
                    </select>
                    <button id="close-chat" class="text-gray-500 hover:text-gray-700">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Chat Messages Container -->
            <div id="messages" class="flex-1 p-4 overflow-y-auto flex flex-col space-y-2">
                <!-- Messages will be injected here by JS -->
            </div>
            
            <!-- Chat Input Area -->
            <div class="p-4 border-t border-gray-300 flex items-center space-x-2 rounded-b-xl">
                <label for="image-upload" class="cursor-pointer">
                    <input type="file" id="image-upload" class="hidden" accept="image/*">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-500 hover:text-pink-600 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                </label>
                <input type="text" id="chat-input" class="flex-1 p-2 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-pink-500 transition-shadow text-sm placeholder-gray-500" placeholder="Ketik pesan..." onkeydown="if(event.key === 'Enter') sendMessage()">
                <button id="send-button" class="p-2 bg-pink-600 text-white rounded-full focus:outline-none focus:ring-2 focus:ring-pink-500 transition-transform transform active:scale-90">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
                    </svg>
                </button>
            </div>
            
        </div>
    </div>

    <script>
        const chatIcon = document.getElementById('chat-icon');
        const chatbox = document.getElementById('chatbox');
        const closeChatButton = document.getElementById('close-chat');
        const messagesContainer = document.getElementById('messages');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');
        const imageUpload = document.getElementById('image-upload');
        const aiModeSelector = document.getElementById('ai-mode-selector');
        
        // Elemen loading
        const loaderContainer = document.getElementById('loader-container');
        const mainContent = document.getElementById('main-content');

        // Elemen untuk efek mengetik
        const typewriterTextElement = document.getElementById('typewriter-text');
        const textToType = "Artificial Intelligence";
        let charIndex = 0;
        let isTyping = true;

        const typeWriter = () => {
            if (charIndex < textToType.length) {
                typewriterTextElement.textContent += textToType.charAt(charIndex);
                charIndex++;
                setTimeout(typeWriter, 50); // Kecepatan mengetik
            } else {
                setTimeout(eraseText, 2000); // Jeda sebelum menghapus
            }
        };

        const eraseText = () => {
            if (charIndex > 0) {
                typewriterTextElement.textContent = textToType.substring(0, charIndex - 1);
                charIndex--;
                setTimeout(eraseText, 25); // Kecepatan menghapus
            } else {
                setTimeout(typeWriter, 500); // Jeda sebelum mulai lagi
            }
        };

        let chatHistory = [];
        isTyping = false;

        // Chatbox toggle
        chatIcon.addEventListener('click', () => {
            chatbox.classList.add('active');
            chatIcon.style.display = 'none';
        });

        closeChatButton.addEventListener('click', () => {
            chatbox.classList.remove('active');
            chatIcon.style.display = 'flex';
        });

        const displayMessage = (text, sender, imageUrl = null) => {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('chat-message', sender === 'user' ? 'user-message' : 'ai-message');
            
            if (imageUrl) {
                const image = document.createElement('img');
                image.src = imageUrl;
                image.classList.add('max-w-full', 'rounded-lg', 'my-2');
                messageDiv.appendChild(image);
            }

            const textNode = document.createElement('p');
            textNode.innerHTML = text.replace(/\n/g, '<br>');
            messageDiv.appendChild(textNode);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        };

        const showTypingIndicator = () => {
            if (isTyping) return;
            isTyping = true;
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.classList.add('chat-message', 'ai-message', 'typing-indicator');
            typingDiv.innerHTML = `
                <p>
                    <span class="inline-block w-2 h-2 bg-gray-500 rounded-full mx-0.5"></span>
                    <span class="inline-block w-2 h-2 bg-gray-500 rounded-full mx-0.5"></span>
                    <span class="inline-block w-2 h-2 bg-gray-500 rounded-full mx-0.5"></span>
                </p>`;
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        };

        const hideTypingIndicator = () => {
            isTyping = false;
            const typingDiv = document.getElementById('typing-indicator');
            if (typingDiv) {
                messagesContainer.removeChild(typingDiv);
            }
        };

        const callAndreAi = async (prompt, imageUrl = null) => {
            showTypingIndicator();
            const apiKey = "AIzaSyD5w83borgoqmFbgHuF1DmrjXxILDCd1hM"; // API key will be provided automatically in runtime
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const selectedMode = aiModeSelector.value;
            let systemPrompt = "";

            switch (selectedMode) {
                case 'Logic':
                    systemPrompt = "Sebagai Andre Ai yang rasional dan informatif, jawablah pertanyaan ini: ";
                    break;
                case 'Joking':
                    systemPrompt = "Sebagai Andre Ai yang lucu dan suka bercanda, jawablah pertanyaan ini dengan nada yang ceria: ";
                    break;
                case 'Angry':
                    systemPrompt = "Sebagai Andre Ai yang sedang marah dan kesal, jawablah pertanyaan ini dengan nada yang kasar dan singkat: ";
                    break;
            }

            const parts = [
                { text: systemPrompt + prompt }
            ];

            if (imageUrl) {
                const base64Data = imageUrl.split(',')[1];
                parts.push({
                    inlineData: {
                        mimeType: "image/png",
                        data: base64Data
                    }
                });
            }

            const payload = {
                contents: [{ parts: parts }]
            };

            let response;
            try {
                response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API call failed with status: ${response.status}`);
                }
                const result = await response.json();
                const aiResponse = result?.candidates?.[0]?.content?.parts?.[0]?.text || "Maaf, saya tidak bisa memproses permintaan ini.";
                displayMessage(aiResponse, 'ai');
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                displayMessage("Maaf, terjadi kesalahan. Mohon coba lagi.", 'ai');
            } finally {
                hideTypingIndicator();
            }
        };

        const sendMessage = async () => {
            const userMessage = chatInput.value.trim();
            const imageFile = imageUpload.files[0];

            if (!userMessage && !imageFile) {
                return;
            }

            chatInput.value = '';
            
            let imageUrl = null;
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = async (e) => {
                    imageUrl = e.target.result;
                    displayMessage(userMessage || "Mengirim gambar...", 'user', imageUrl);
                    await callAndreAi(userMessage, imageUrl);
                };
                reader.readAsDataURL(imageFile);
            } else {
                displayMessage(userMessage, 'user');
                await callAndreAi(userMessage);
            }
            imageUpload.value = '';
        };

        sendButton.addEventListener('click', sendMessage);

        // Tambahkan event listener untuk mode AI
        aiModeSelector.addEventListener('change', (event) => {
            const selectedMode = event.target.value;
            let confirmationMessage = "";
            switch (selectedMode) {
                case 'Logic':
                    confirmationMessage = "Mode Logika Aktif. Tanyakan saya hal-hal yang serius dan informatif.";
                    break;
                case 'Joking':
                    confirmationMessage = "Mode Bercanda Aktif. Siap melontarkan lelucon dan guyonan!";
                    break;
                case 'Angry':
                    confirmationMessage = "Mode Marah Aktif. Aku sedang bad mood, jangan tanya aneh-aneh!";
                    break;
                default:
                    confirmationMessage = "Mode tidak dikenal.";
                    break;
            }
            displayMessage(confirmationMessage, 'ai');
        });

        // Panggil fungsi untuk mengelola loading dan efek mengetik
        window.addEventListener('load', () => {
            setTimeout(() => {
                loaderContainer.style.opacity = '0';
                loaderContainer.style.pointerEvents = 'none';
                mainContent.style.display = 'block';
                document.body.style.overflow = 'auto'; // Mengaktifkan kembali scrolling
                typeWriter(); // Mulai efek mengetik setelah loading selesai
            }, 1000); // Penundaan 1 detik
        });
    </script>

</body>
</html>
